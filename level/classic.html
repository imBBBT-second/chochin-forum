<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="user-scalable=no, initial-scale=1.0" />
  <title>초친 포럼 (레벨 - 클래식)</title>

  <style>
    html, body {
      height: 100%;
      margin: 0;
      background: #323232;
      display: flex;
      flex-direction: column;
    }
    * { box-sizing: border-box; }

    @font-face { font-family: Paperlogy2; src: url('font - paperlogy/Paperlogy-2.ttf'); }
    @font-face { font-family: Paperlogy3; src: url('font - paperlogy/Paperlogy-3.ttf'); }
    @font-face { font-family: Paperlogy5; src: url('font - paperlogy/Paperlogy-5.ttf'); }
    @font-face { font-family: Paperlogy7; src: url('font - paperlogy/Paperlogy-7.ttf'); }
    @font-face { font-family: Paperlogy9; src: url('font - paperlogy/Paperlogy-9.ttf'); }

    h1 { color:#fff; font-family:Paperlogy7; font-size:160px; text-align:center; }
    p { color:#c8c8c8; font-family:Paperlogy2; }
    a { color:inherit; text-decoration:none; }

    .header-container {
      display:flex;
      justify-content:center;
      gap:5vw;
      padding:2vh 0;
    }
    .header-btn {
      width:400px;
      background:#323232;
      color:#fff;
      border:none;
      font-size:3rem;
      font-family:Paperlogy5;
      cursor:pointer;
    }

    .divider { border:2px solid white; }

    .main-container {
      flex:1;
      display:flex;
      gap:2%;
      padding:2%;
    }

    .container {
      width:25%;
      background:#404040;
      border-radius:10px;
      padding:1.5%;
      overflow-y:auto;
    }

    input {
      width:100%;
      padding:8px;
      margin-bottom:10px;
      border-radius:8px;
      border:none;
    }

    .item {
      display:flex;
      gap:10px;
      padding:8px 0;
      border-bottom:1px solid #666;
      cursor:pointer;
    }

    .rank { color:#fff; width:40px; font-family:Paperlogy7; }
    .title { color:#fff; font-family:Paperlogy5; }
    .creator { font-size:12px; color:#aaa; }

    .detail-panel {
      flex:1;
      background:#505050;
      border-radius:10px;
      padding:2%;
      overflow-y:auto;
      color:#fff;
      display:flex;
      flex-direction:column;
    }

    .clears-panel {
      width:25%;
      flex:none;
    }

    .detail-title {
      text-align:center;
      font-family:Paperlogy9;
      font-size:3vw;
    }

    .video-wrapper {
      position:relative;
      width:100%;
      padding-top:56.25%;
      margin:15px 0;
    }
    .video-wrapper iframe {
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      border:none;
    }

    .section {
      background:#444;
      padding:12px;
      border-radius:8px;
      margin-bottom:12px;
    }
    .section-title {
      font-family:Paperlogy5;
      margin-bottom:8px;
    }

    .info-grid {
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:6px 12px;
    }

    .info-row {
      display:flex;
      justify-content:space-between;
      font-size:14px;
    }
    .label { color:#aaa; }
    .value { color:#fff; }

    .bar-row {
      display:grid;
      grid-template-columns:60px 1fr 50px;
      align-items:center;
      gap:8px;
      margin:4px 0;
    }
    .bar-bg {
      background:#333;
      height:10px;
      border-radius:6px;
      overflow:hidden;
    }
    .bar-fill {
      height:100%;
      background:linear-gradient(90deg,#5fd3ff,#4aa3ff);
    }

    .fp-bars {
      display:flex;
      align-items:flex-end;
      gap:10px;
      height:80px;
      margin-top:10px;
    }
    .fp-bar {
      flex:1;
      background:#6aa8ff;
      border-radius:6px 6px 0 0;
      font-size:12px;
      text-align:center;
    }

    .tag {
      display:inline-block;
      background:#666;
      padding:4px 8px;
      border-radius:6px;
      margin:3px;
      font-size:12px;
    }
  </style>
</head>

<body>
  <div class="header-container">
    <a href="../index.html"><button class="header-btn">홈</button></a>
    <a href="../level.html"><button class="header-btn">레벨</button></a>
    <button class="header-btn">하디스트</button>
  </div>

  <div class="divider"></div>

  <h1>Classic</h1>

  <div class="main-container">
    <div class="container">
      <input id="search" placeholder="검색" />
      <div id="list"></div>
    </div>

    <div class="detail-panel">
      <div class="detail-title" id="detailTitle"></div>
      <p id="detailCreator" style="text-align:center;"></p>

      <div class="video-wrapper">
        <iframe id="detailVideo" allowfullscreen></iframe>
      </div>

      <div id="detailDescription"></div>
    </div>

    <div class="detail-panel clears-panel">
      <div style="text-align:center;font-family:Paperlogy9;font-size:2vw">클리어 명단</div>
      <div id="detailClears"></div>
    </div>
  </div>

  <script>
    let demonData = [];

    function bar(label, value) {
      return `
        <div class="bar-row">
          <span>${label}</span>
          <div class="bar-bg"><div class="bar-fill" style="width:${value}%"></div></div>
          <span>${value}%</span>
        </div>`;
    }

    function showDetail(item) {
      detailTitle.textContent = item.title;
      detailCreator.textContent =
        item.creator === item.verifier ? `by ${item.creator}` :
        `by ${item.creator} / Verified by ${item.verifier}`;
      detailVideo.src = item.video || '';

      const box = detailDescription;
      box.innerHTML = '';

      box.innerHTML += `
        <div class="section">
          <div class="section-title">맵 정보</div>
          <div class="info-grid">
            <div class="info-row"><span class="label">맵 ID</span><span>${item.map.mapId}</span></div>
            <div class="info-row"><span class="label">길이</span><span>${item.map.length}</span></div>
            <div class="info-row"><span class="label">오브젝트</span><span>${item.map.objects}</span></div>
            <div class="info-row"><span class="label">업로드</span><span>${item.map.uploadDate}</span></div>
          </div>
        </div>`;

      box.innerHTML += `
        <div class="section">
          <div class="section-title">게임모드 비율</div>
          ${Object.entries(item.gameplay.modeRatio).map(([k,v])=>bar(k,v)).join('')}
        </div>`;

      box.innerHTML += `
        <div class="section">
          <div class="section-title">속도 비율</div>
          ${Object.entries(item.gameplay.speedRatio).map(([k,v])=>bar(k,v)).join('')}
        </div>`;

      const f = item.framePerfect.fps;
      const max = Math.max(...Object.values(f),1);
      box.innerHTML += `
        <div class="section">
          <div class="section-title">프레임 퍼펙트</div>
          <div class="fp-bars">
            ${Object.entries(f).map(([k,v]) =>
              `<div class="fp-bar" style="height:${v/max*100}%">${k}</div>`
            ).join('')}
          </div>
        </div>`;

      box.innerHTML += `
        <div class="section">
          <div class="section-title">태그</div>
          ${item.tags.map(t=>`<span class="tag">#${t}</span>`).join('')}
        </div>`;

      detailClears.innerHTML = item.clears.length
        ? item.clears.map((c,i)=>`<p>${i+1}. ${c}</p>`).join('')
        : '<p style="color:#aaa;text-align:center">클리어 없음</p>';
    }

    function generateList(data) {
      list.innerHTML = '';
      data.forEach(item => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
          <div class="rank">${item.id}</div>
          <div>
            <div class="title">${item.title}</div>
            <div class="creator">by ${item.creator}</div>
          </div>`;
        div.onclick = () => showDetail(item);
        list.appendChild(div);
      });
    }

    fetch('classic.json')
      .then(r=>r.json())
      .then(j=>{
        demonData = j.buttons;
        generateList(demonData);
        if (demonData.length) showDetail(demonData[0]);
      });

    search.oninput = () => {
      const t = search.value.toLowerCase();
      generateList(demonData.filter(d=>d.title.toLowerCase().includes(t)));
    };
  </script>
</body>
</html>
